 <!-- Favicon -->
  <link rel="icon" href="/assets/images/logo/logo1.png" sizes="any" />
  <link rel="apple-touch-icon" href="/assets/images/logo/logo1.png" />

  <!-- Fonts (async loading) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet"></noscript>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Poppins', 'sans-serif'] },
          colors: {
            primary: '#1e3a8a',
            secondary: '#0ea5e9',
            accent: '#fbbf24',
            soft: '#e0f2fe',
            dark: '#0f172a',
            brand: '#0A1E5C',
            muted: '#64748B',
          },
          boxShadow: {
            soft: '0 10px 30px rgba(30,58,138,0.15)',
            premium: '0 25px 60px rgba(30,58,138,0.25)',
          },
          borderRadius: { xl: '1.25rem' },
        },
      },
    }
  </script>

  <!-- Font Awesome (async) -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"></noscript>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <!-- Component CSS (async) -->
  <link rel="preload" href="/assets/css/page.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/css/page.css"></noscript>
  <link rel="stylesheet" href="/assets/css/page.css">

  <link rel="preload" href="/assets/css/theme.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/css/theme.css"></noscript>
  <link rel="stylesheet" href="/assets/css/theme.css">

  <link rel="preload" href="/assets/css/animations.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/css/animations.css"></noscript>
  <link rel="stylesheet" href="/assets/css/animations.css">

  <link rel="preload" href="/components/navbar.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/components/navbar.css"></noscript>
  <link rel="stylesheet" href="/components/navbar.css">

  <link rel="preload" href="/components/footer.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/components/footer.css"></noscript>
  <link rel="stylesheet" href="/components/footer.css">
</head>

<body class="bg-slate-50 text-slate-800 min-h-screen font-sans overflow-x-hidden">


    <!-- NAVBAR -->
<div id="navbar"></div>



  <main class="pt-20 pb-16 md:pt-24">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">

<!-- Compact Page Header -->
<header class="text-center mb-6 md:mb-8">
  <h1 class="text-2xl md:text-3xl font-bold text-primary mb-2">
    Pay Your Membership Dues
  </h1>
  <p class="text-muted max-w-2xl mx-auto text-sm md:text-base">
    Securely contribute via bank transfer. Payments are manually verified.
  </p>
</header>

<!-- Compact Stepper -->
<div class="stepper-container flex items-center justify-center mb-8">
  <div class="step-indicator completed" id="step-ind-1">1</div>
  <div class="step-line" id="line-1"></div>
  <div class="step-indicator" id="step-ind-2">2</div>
  <div class="step-line" id="line-2"></div>
  <div class="step-indicator" id="step-ind-3">3</div>
  <div class="step-line" id="line-3"></div>
  <div class="step-indicator" id="step-ind-4">4</div>
</div>

<div class="flex justify-center gap-4 md:gap-8 flex-wrap text-xs md:text-sm mb-6">
  <span id="step-label-1" class="font-bold text-primary">Confirm Details</span>
  <span id="step-label-2" class="font-semibold text-muted">Review & Amount</span>
  <span id="step-label-3" class="font-semibold text-muted">Make Payment</span>
  <span id="step-label-4" class="font-semibold text-muted">Confirmation</span>
</div>

<!-- Swipeable Steps Container -->
<div id="steps-carousel" class="overflow-x-hidden relative">
  <!-- Step 1: Search & Confirm Details -->
  <section id="step-1" class="step-content min-w-full">
    <div class="bg-white rounded-2xl shadow-xl p-5 md:p-8 max-w-3xl mx-auto">
      <h2 class="text-xl md:text-2xl font-bold text-center text-primary mb-3">
        Confirm Your Details
      </h2>
      <p class="text-center text-muted mb-6 text-sm">Type your full name to load your details.</p>

      <div class="relative max-w-md mx-auto mb-8">
        <input id="name-input" type="text" placeholder="Enter your full name" 
               class="w-full px-5 py-4 rounded-xl border-2 border-gray-300 focus:border-primary focus:ring-4 focus:ring-primary/20 outline-none text-base">
        <div id="suggestions" class="absolute top-full left-0 w-full bg-white border border-gray-300 rounded-b-xl shadow-xl max-h-48 overflow-y-auto hidden z-20"></div>
      </div>

      <div id="confirmed-details" class="mt-8 bg-primary/5 rounded-xl p-5 hidden">
        <h4 class="text-lg font-bold text-center text-primary mb-4">Confirmed Details</h4>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center text-sm">
          <div><p class="text-muted">Name</p><p id="confirm-name" class="font-bold">-</p></div>
          <div><p class="text-muted">Email</p><p id="confirm-email" class="font-bold">-</p></div>
          <div><p class="text-muted">Member ID</p><p id="confirm-id" class="font-bold">-</p></div>
        </div>
      </div>

      <div class="mt-8 text-center">
        <button id="next-1" class="px-8 py-4 bg-primary text-white font-bold rounded-xl hover:scale-105 transition shadow-lg opacity-50 cursor-not-allowed w-full md:w-auto text-base" disabled>
          Continue <i class="fas fa-arrow-right ml-3"></i>
        </button>
      </div>
    </div>
  </section>

  <!-- Step 2: Outstanding + Amount Input -->
  <section id="step-2" class="step-content min-w-full hidden">
    <div class="bg-white rounded-2xl shadow-xl p-5 md:p-8 mx-auto">
      <!-- Member Summary -->
      <div class="bg-card-bg rounded-2xl p-5 shadow-card border border-gray-200 mb-6">
        <h3 class="text-lg font-bold text-primary mb-4">Member Summary</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center text-sm">
          <div><p class="text-muted">Name</p><p id="member-name-2" class="font-bold"></p></div>
          <div><p class="text-muted">Email</p><p id="member-email-2" class="font-bold"></p></div>
          <div><p class="text-muted">Member ID</p><p id="member-id-2" class="font-bold"></p></div>
        </div>
      </div>

      <!-- Contribution Guidelines -->
      <div class="bg-card-bg rounded-2xl p-5 shadow-card border border-gray-200 mb-6">
        <h3 class="text-lg font-bold text-primary mb-4">Contribution Guidelines</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="flex items-center gap-3">
            <i class="fas fa-calendar-day text-3xl text-primary"></i>
            <div>
              <p class="font-bold">Monthly</p>
              <p class="text-xl font-bold text-primary">₦2,000</p>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <i class="fas fa-calendar text-3xl text-primary"></i>
            <div>
              <p class="font-bold">Annual</p>
              <p class="text-xl font-bold text-primary">₦24,000</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Dues Status Table -->
      <div class="bg-card-bg rounded-2xl p-5 shadow-card border border-gray-200 mb-6 overflow-x-auto">
        <h3 class="text-lg font-bold text-primary mb-4">Dues Status (2025 – 2026)</h3>
        <table class="w-full text-left text-sm min-w-[500px]">
          <thead>
            <tr class="border-b">
              <th class="pb-3 text-xs">Year</th>
              <th class="pb-3 text-xs">Expected</th>
              <th class="pb-3 text-xs">Confirmed Paid</th>
              <th class="pb-3 text-xs">Pending</th>
              <th class="pb-3 text-xs">Outstanding</th>
            </tr>
          </thead>
          <tbody id="dues-table"></tbody>
          <tfoot class="border-t font-bold text-sm">
            <tr>
              <td class="pt-3" colspan="2">Totals</td>
              <td id="total-paid" class="pt-3">₦0</td>
              <td id="total-pending" class="pt-3 text-warning">₦0</td>
              <td id="total-outstanding" class="pt-3 text-danger">₦0</td>
            </tr>
          </tfoot>
        </table>
      </div>

      <!-- Status Message -->
      <div id="status-message" class="text-center py-6 mb-6 text-sm"></div>

      <!-- Amount to Pay -->
      <div class="bg-card-bg rounded-2xl p-5 shadow-card border border-gray-200 mb-6">
        <h3 class="text-lg font-bold text-primary mb-4 text-center">Amount You Wish to Pay</h3>
        <div class="max-w-xs mx-auto">
          <input id="pay-amount" type="number" min="1000" step="1000" placeholder="Enter amount (₦)"
                 class="w-full px-5 py-4 rounded-xl border-2 border-gray-300 focus:border-primary focus:ring-4 focus:ring-primary/20 outline-none text-xl font-bold text-center">
          <p class="text-center text-muted mt-3 text-xs">Any amount — partial, full, or extra.</p>
        </div>
      </div>

      <!-- Admin Notice -->
      <div class="bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl p-5 shadow-card text-center mb-6">
        <p class="text-primary font-bold text-sm">Bank transfers verified within 24-48 hours.</p>
      </div>

      <div class="flex flex-col md:flex-row gap-4 justify-center">
        <button id="prev-2" class="px-8 py-4 bg-gray-300 text-gray-700 rounded-xl font-bold hover:bg-gray-400 transition w-full md:w-auto text-base">
          <i class="fas fa-arrow-left mr-3"></i>Back
        </button>
        <button id="next-2" class="px-8 py-4 bg-primary text-white rounded-xl font-bold hover:scale-105 transition shadow-lg w-full md:w-auto text-base">
          Continue <i class="fas fa-arrow-right ml-3"></i>
        </button>
      </div>
    </div>
  </section>

  <!-- Step 3: Payment -->
  <section id="step-3" class="step-content min-w-full hidden">
    <div class="bg-white rounded-2xl shadow-xl p-5 md:p-8 max-w-3xl mx-auto">
      <h2 class="text-xl md:text-2xl font-bold text-center text-primary mb-6">
        Bank Transfer Details
      </h2>

      <div class="text-center mb-8">
        <p class="text-lg md:text-xl font-semibold mb-4">
          Transfer <span id="transfer-amount" class="font-bold text-3xl text-primary">₦0</span>
        </p>
        <p class="text-sm text-muted">
          Narration: "<strong>Dues - <span id="transfer-desc">Member ID or Name</span></strong>"
        </p>
      </div>

      <div class="border-4 border-dashed border-primary/30 rounded-2xl p-8 bg-primary/5">
        <div class="text-center mb-8">
          <i class="fas fa-building-columns text-6xl text-primary mb-4"></i>
          <p class="text-xl font-bold">Wema Bank</p>
        </div>

        <div class="space-y-6 max-w-md mx-auto text-sm">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 bg-white rounded-xl p-5 shadow">
            <div>
              <p class="text-muted">Account Name</p>
              <p class="font-bold" id="acc-name">Ipakodo Grammar School 1998 Set Alumni</p>
            </div>
            <button onclick="copyToClipboard('acc-name')" class="copy-btn w-full md:w-auto text-xs">Copy</button>
          </div>

          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 bg-white rounded-xl p-5 shadow">
            <div>
              <p class="text-muted">Account Number</p>
              <p class="font-bold text-2xl tracking-wider" id="acc-num">0251911326</p>
            </div>
            <button onclick="copyToClipboard('acc-num')" class="copy-btn w-full md:w-auto text-xs">Copy</button>
          </div>
        </div>

        <div class="mt-10 text-center">
          <button id="confirm-transfer" class="px-12 py-6 bg-success text-white text-xl font-bold rounded-xl hover:scale-105 transition shadow-2xl w-full md:w-auto">
            <i class="fas fa-check mr-3"></i>I Have Made the Transfer
          </button>
        </div>
      </div>

      <p class="text-center text-muted mt-8 text-sm">Online payments coming soon.</p>

      <div class="mt-8 text-center">
        <button id="prev-3" class="px-8 py-4 bg-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-400 transition w-full md:w-auto text-base">
          <i class="fas fa-arrow-left mr-3"></i> Back
        </button>
      </div>
    </div>
  </section>

  <!-- Step 4: Thank You -->
  <section id="step-4" class="step-content min-w-full hidden text-center">
    <div class="bg-white rounded-2xl shadow-xl p-6 md:p-12 max-w-3xl mx-auto">
      <i class="fas fa-heart text-6xl md:text-8xl text-success mb-6"></i>
      <h2 class="text-2xl md:text-4xl font-bold text-success mb-4">
        Thank You, <span id="thank-name">Member</span>!
      </h2>
      <p class="text-lg md:text-xl mb-4">
        Your <span id="thank-amount" class="font-bold text-primary">₦0</span> contribution recorded.
      </p>
      <p class="text-sm md:text-base text-gray-700 leading-relaxed max-w-2xl mx-auto mb-8">
        Verification soon.<br>
        Questions? <a href="mailto:accounts@ipakodo1998setalumni.org" class="text-primary underline font-bold">accounts@ipakodo1998setalumni.org</a>
      </p>

      <div class="flex flex-col md:flex-row gap-4 justify-center">
        <a href="/index.html" class="px-8 py-4 bg-primary text-white rounded-xl font-bold hover:scale-105 transition shadow-lg w-full md:w-auto text-base">
          Return to Home
        </a>
        <a href="/profile.html" class="px-8 py-4 bg-gray-700 text-white rounded-xl font-bold hover:scale-105 transition shadow-lg w-full md:w-auto text-base">
          View Profile
        </a>
      </div>
    </div>
  </section>
</div>
</main>

<!-- FOOTER -->
<div id="footer"></div>

<style>
  /* Disable tap highlight */
  input, button { -webkit-tap-highlight-color: transparent; }

  /* STEPPER */
  .step-indicator {
    width: 2.5rem; height: 2.5rem;
    border-radius: 9999px; color: #fff; font-weight: 500;
    display: flex; align-items: center; justify-content: center;
    background-color: #9ca3af; transition: all 0.3s ease;
  }
  .step-indicator.current {
    background-color: var(--color-primary, #2563eb);
    box-shadow: 0 0 0 4px rgba(30,58,138,.25);
  }
  .step-indicator.completed { background-color: #16a34a; }

  .step-line {
    flex: 1; height: 0.25rem; background-color: #d1d5db;
    margin: 0 0.5rem; display: none;
  }
  .step-line.completed { background-color: #16a34a; }
  @media (min-width: 640px) { .step-line { display: block; } }

  /* COPY BUTTON */
  .copy-btn {
    padding: 0.5rem 1rem; font-size: 0.75rem;
    background-color: var(--color-primary, #2563eb); color: #fff;
    border-radius: 0.5rem; border: none; cursor: pointer;
    transition: background-color .3s ease;
  }
  .copy-btn:hover { background-color: rgba(37,99,235,.9); }

  /* SCROLLBAR HIDE */
  .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
  .no-scrollbar::-webkit-scrollbar { display: none; }

  /* MOBILE OPTIMIZATIONS (kept minimal since layout is now compact overall) */
  @media (max-width: 640px) {
    .stepper-container { flex-direction: column; gap: 1rem; }
    .step-indicator { width: 3rem; height: 3rem; font-size: 1rem; }
    button, input { font-size: 1rem !important; padding: 0.875rem !important; }
  }
</style>
  <script type="module">
    import { supabase } from '../../assets/js/supabase-client.js';

    const FULL_YEAR_DUES = 24000;
    const CURRENT_YEAR = 2026;
    const YEARS = [2025, 2026];

    let currentMember = null;
    let duesData = {}; // { year: { amount: 0, pending_verification: 0 } }
    let totalPaid = 0;
    let totalPending = 0;
    let totalOutstanding = 0;
    let payAmount = 0;

    const steps = {
      1: document.getElementById('step-1'),
      2: document.getElementById('step-2'),
      3: document.getElementById('step-3'),
      4: document.getElementById('step-4')
    };

    let currentStep = 1;

    function showStep(step) {
      currentStep = step;
      Object.values(steps).forEach(s => s.classList.add('hidden'));
      steps[step].classList.remove('hidden');

      document.querySelectorAll('.step-indicator').forEach((ind, i) => {
        const num = i + 1;
        ind.classList.remove('completed', 'current');
        if (num < step) ind.classList.add('completed');
        if (num === step) ind.classList.add('current');
      });
      document.querySelectorAll('.step-line').forEach((line, i) => {
        line.classList.toggle('completed', i + 1 < step);
      });
      document.querySelectorAll('[id^="step-label-"]').forEach((el, i) => {
        const num = i + 1;
        el.classList.toggle('text-primary', num === step);
        el.classList.toggle('font-bold', num === step || num < step);
        el.classList.toggle('text-success', num < step);
        el.classList.toggle('text-muted', num > step);
      });
    }

    window.copyToClipboard = async function(elementId) {
      const text = document.getElementById(elementId).textContent.trim();
      try {
        await navigator.clipboard.writeText(text);
        alert('Copied: ' + text);
      } catch (err) {
        alert('Copy failed — select and copy manually');
      }
    };

    const nameInput = document.getElementById('name-input');
    const suggestions = document.getElementById('suggestions');
    let debounceTimeout;

    nameInput.addEventListener('input', () => {
      clearTimeout(debounceTimeout);
      debounceTimeout = setTimeout(async () => {
        const query = nameInput.value.trim();
        suggestions.innerHTML = '';
        suggestions.classList.add('hidden');

        if (query.length < 3) return;

        const { data, error } = await supabase
          .from('members')
          .select('full_name, email_address, member_id_no')
          .ilike('full_name', `%${query}%`)
          .limit(10);

        if (error || !data || data.length === 0) {
          suggestions.innerHTML = '<div class="p-4 text-center text-muted">No matches found</div>';
          suggestions.classList.remove('hidden');
          return;
        }

        data.forEach(member => {
          const div = document.createElement('div');
          div.className = 'p-4 hover:bg-primary/10 cursor-pointer border-b border-gray-200 last:border-0';
          div.textContent = `${member.full_name} ${member.email_address ? `— ${member.email_address}` : ''} ${member.member_id_no ? `(ID: ${member.member_id_no})` : ''}`;
          div.onclick = () => {
            nameInput.value = member.full_name;
            currentMember = member;
            document.getElementById('confirm-name').textContent = member.full_name;
            document.getElementById('confirm-email').textContent = member.email_address || '—';
            document.getElementById('confirm-id').textContent = member.member_id_no || '—';
            document.getElementById('confirmed-details').classList.remove('hidden');
            suggestions.classList.add('hidden');
            document.getElementById('next-1').disabled = false;
            document.getElementById('next-1').classList.remove('opacity-50', 'cursor-not-allowed');
          };
          suggestions.appendChild(div);
        });

        suggestions.classList.remove('hidden');
      }, 500);
    });

    document.getElementById('next-1').addEventListener('click', async () => {
      await loadDuesAndSummary();
      showStep(2);
    });

    document.getElementById('prev-2').addEventListener('click', () => showStep(1));

    document.getElementById('next-2').addEventListener('click', () => {
      payAmount = Number(document.getElementById('pay-amount').value);
      if (payAmount < 1000 || isNaN(payAmount)) {
        alert('Please enter a valid amount (minimum ₦1,000)');
        return;
      }
      document.getElementById('transfer-amount').textContent = '₦' + payAmount.toLocaleString();
      const desc = currentMember.member_id_no ? `Member ID: ${currentMember.member_id_no}` : currentMember.full_name;
      document.getElementById('transfer-desc').textContent = desc;
      showStep(3);
    });

    document.getElementById('prev-3').addEventListener('click', () => showStep(2));

    document.getElementById('confirm-transfer').addEventListener('click', async () => {
      if (!confirm(`Confirm you have transferred ₦${payAmount.toLocaleString()}?`)) return;

      const displayName = currentMember.full_name.split(' ')[0] || 'Member';

      document.getElementById('thank-name').textContent = displayName;
      document.getElementById('thank-amount').textContent = '₦' + payAmount.toLocaleString();

      if (!currentMember.member_id_no) {
        alert('No Member ID found. Please email proof to accounts@ipakodo1998setalumni.org');
        showStep(4);
        return;
      }

      const { data: existing, error: fetchError } = await supabase
        .from('membership_dues')
        .select('id, pending_verification')
        .eq('member_id_no', currentMember.member_id_no)
        .eq('dues_year', CURRENT_YEAR);

      let error;
      if (existing && existing.length > 0) {
        const newPending = (existing[0].pending_verification || 0) + payAmount;
        ({ error } = await supabase
          .from('membership_dues')
          .update({ pending_verification: newPending, updated_at: new Date().toISOString() })
          .eq('id', existing[0].id));
      } else {
        ({ error } = await supabase
          .from('membership_dues')
          .insert({
            member_id_no: currentMember.member_id_no,
            full_name: currentMember.full_name,
            dues_year: CURRENT_YEAR,
            pending_verification: payAmount,
            submitted_at: new Date().toISOString(),
            status: 'pending_verification'
          }));
      }

      if (error) {
        console.error(error);
        alert('Recording failed — please email proof to accounts@ipakodo1998setalumni.org');
      } else {
        alert('Thank you! Your payment is recorded and awaiting verification.');
      }

      showStep(4);
    });

    async function loadDuesAndSummary() {
      document.getElementById('member-name-2').textContent = currentMember.full_name;
      document.getElementById('member-email-2').textContent = currentMember.email_address || '—';
      document.getElementById('member-id-2').textContent = currentMember.member_id_no || '—';

      duesData = {};
      YEARS.forEach(year => duesData[year] = { amount: 0, pending_verification: 0 });

      if (currentMember.member_id_no) {
        const { data, error } = await supabase
          .from('membership_dues')
          .select('dues_year, amount, pending_verification')
          .eq('member_id_no', currentMember.member_id_no)
          .in('dues_year', YEARS);

        if (data) {
          data.forEach(row => {
            duesData[row.dues_year] = {
              amount: row.amount || 0,
              pending_verification: row.pending_verification || 0
            };
          });
        }
      }

      renderDuesTable();
      updateStatusMessage();

      const outstanding = Math.max(FULL_YEAR_DUES - duesData[CURRENT_YEAR].amount, 0);
      document.getElementById('pay-amount').value = outstanding || FULL_YEAR_DUES;
    }

    function renderDuesTable() {
      const tableBody = document.getElementById('dues-table');
      tableBody.innerHTML = '';
      totalPaid = 0;
      totalPending = 0;
      totalOutstanding = 0;

      YEARS.forEach(year => {
        const paid = duesData[year].amount;
        const pending = duesData[year].pending_verification;
        const outstanding = Math.max(FULL_YEAR_DUES - paid, 0);

        totalPaid += paid;
        totalPending += pending;
        totalOutstanding += outstanding;

        const row = `
          <tr>
            <td class="py-3">${year}</td>
            <td class="py-3">₦${FULL_YEAR_DUES.toLocaleString()}</td>
            <td class="py-3">₦${paid.toLocaleString()}</td>
            <td class="py-3 text-warning">₦${pending.toLocaleString()}</td>
            <td class="py-3 text-danger">₦${outstanding.toLocaleString()}</td>
          </tr>
        `;
        tableBody.innerHTML += row;
      });

      document.getElementById('total-paid').textContent = `₦${totalPaid.toLocaleString()}`;
      document.getElementById('total-pending').textContent = `₦${totalPending.toLocaleString()}`;
      document.getElementById('total-outstanding').textContent = `₦${totalOutstanding.toLocaleString()}`;
    }

    function updateStatusMessage() {
      const statusDiv = document.getElementById('status-message');
      let html = '';

      if (totalOutstanding === 0 && totalPending === 0) {
        html = '<i class="fas fa-check-circle text-6xl text-success mb-4 block"></i><h3 class="text-2xl font-bold text-success mb-2">Fully Paid!</h3><p>Thank you for your support.</p>';
      } else if (totalPending > 0) {
        html = '<i class="fas fa-clock text-6xl text-warning mb-4 block"></i><h3 class="text-2xl font-bold text-warning mb-2">Pending Verification</h3><p>₦' + totalPending.toLocaleString() + ' awaiting confirmation.</p>';
      } else {
        html = '<i class="fas fa-exclamation-circle text-6xl text-danger mb-4 block"></i><h3 class="text-2xl font-bold text-danger mb-2">Outstanding Balance</h3><p>₦' + totalOutstanding.toLocaleString() + ' remaining.</p>';
      }

      statusDiv.innerHTML = html;
    }

    // Swipe Gestures for Steps on Mobile
    let touchStartX = 0;
    let touchEndX = 0;

    const stepsCarousel = document.getElementById('steps-carousel');
    stepsCarousel.addEventListener('touchstart', e => {
      touchStartX = e.changedTouches[0].screenX;
    });
    stepsCarousel.addEventListener('touchend', e => {
      touchEndX = e.changedTouches[0].screenX;
      if (touchStartX - touchEndX > 50 && currentStep < 4) {
        showStep(currentStep + 1);
      } else if (touchEndX - touchStartX > 50 && currentStep > 1) {
        showStep(currentStep - 1);
      }
    });

    showStep(1);
  </script>

  <!-- PWA Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').then(reg => {
          console.log('SW registered!', reg);
        }).catch(err => {
          console.log('SW registration failed: ', err);
        });
      });
    }
  </script>

</style>

<!-- Scripts -->
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/loader.js"></script>
<script src="/assets/js/page.js"></script>
<script src="/components/navbar.js"></script>
<script src="/components/footer.js"></script>

</body>
</html>